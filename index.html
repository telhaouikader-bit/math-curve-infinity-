<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MathCurve Infinity Path</title>
    <style>
        /* سأختصر الـ CSS هنا لضمان عمل المحرك */
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Share+Tech+Mono&display=swap');
        :root { --bg: #050a10; --green: #00ff88; --red: #ff2a2a; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--bg); overflow: hidden; font-family: 'Orbitron', sans-serif; color: white; }
        canvas { display: block; width: 100%; height: 100%; background: #050a10; }
        #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; padding: 20px; box-sizing: border-box; }
        .modal { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(5, 10, 16, 0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; pointer-events: auto; }
        .btn { background: var(--green); color: black; border: none; padding: 20px 40px; font-size: 1.5rem; font-family: 'Orbitron'; cursor: pointer; text-transform: uppercase; font-weight: bold; border-radius: 5px; box-shadow: 0 0 20px rgba(0,255,136,0.4); }
        .hidden { display: none !important; }
        #score-display { font-family: 'Share Tech Mono'; font-size: 2.5rem; color: var(--green); }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="ui-layer">
        <div id="score-display">1.00</div>
    </div>
    <div id="start-screen" class="modal">
        <h1 style="text-align:center; color: var(--green);">MATHCURVE<br>INFINITY</h1>
        <button class="btn" id="start-btn">Start Trading</button>
        <p style="margin-top:20px; color:#666;">Drag UP / DOWN to move</p>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const startBtn = document.getElementById('start-btn');
        const startScreen = document.getElementById('start-screen');
        const scoreEl = document.getElementById('score-display');

        let isPlaying = false;
        let score = 1;
        let playerY = 0.5;
        let targetY = 0.5;

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // دعم اللمس (Touch) والماوس (Mouse)
        function updateInput(e) {
            let y = e.touches ? e.touches[0].clientY : e.clientY;
            targetY = y / canvas.height;
        }
        window.addEventListener('mousemove', (e) => { if(isPlaying) updateInput(e); });
        window.addEventListener('touchmove', (e) => { e.preventDefault(); if(isPlaying) updateInput(e); }, {passive: false});

        function startGame() {
            console.log("Game Starting..."); // للتأكد في المتصفح
            isPlaying = true;
            score = 1;
            startScreen.classList.add('hidden');
            requestAnimationFrame(loop);
        }

        // استخدام "pointerdown" لضمان العمل على كل الأجهزة
        startBtn.addEventListener('pointerdown', (e) => {
            e.stopPropagation();
            startGame();
        });

        function loop() {
            if (!isPlaying) return;
            
            // تحريك اللاعب بسلاسة
            playerY += (targetY - playerY) * 0.1;
            
            // رسم الخلفية
            ctx.fillStyle = '#050a10';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // رسم اللاعب (نقطة خضراء)
            ctx.beginPath();
            ctx.arc(100, playerY * canvas.height, 15, 0, Math.PI * 2);
            ctx.fillStyle = '#00ff88';
            ctx.fill();
            ctx.shadowBlur = 15;
            ctx.shadowColor = '#00ff88';
            
            score += 0.01;
            scoreEl.innerText = score.toFixed(2);
            
            requestAnimationFrame(loop);
        }
    </script>
</body>
</html>
